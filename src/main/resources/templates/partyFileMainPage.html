<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8"> <!-- 문서의 문자 인코딩을 UTF-8로 설정 -->
   <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- 모바일 친화적인 화면 비율 설정 -->
   <title>Study Village</title> <!-- 문서 제목 설정 -->
   <!-- Font Awesome 라이브러리 추가 -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
   <!-- 외부 헤더 스타일 연결 -->

   <link rel="stylesheet" href="/styles/basic/header.css">
   <link rel="stylesheet" href="/styles/basic/nav.css">
   <link rel="stylesheet" href="/styles/basic/toolBarStyle.css">
   <link rel="stylesheet" href="/styles/basic/footer.css">

   <!--구글 폰트-->
   <link rel="preconnect" href="https://fonts.googleapis.com">
   <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=IBM+Plex+Sans+KR&family=Orbit&display=swap" rel="stylesheet">

   <style>
      body {
         margin: 0;
         display: flex;
         flex-direction: column; /* 세로로 정렬 */
         min-height: 100vh; /* Viewport Height 설정 */
      }

      #main-layout {
         display: flex;
         flex-direction: row; /* 가로 정렬 */
         align-items: flex-start;
         gap: 20px;
         padding: 20px;
         box-sizing: border-box;
         flex: 1; /* 남은 공간을 채워서 footer를 아래로 밀도록 설정 */
      }

      footer {
         background-color: rgba(104, 86, 82, 0.8);
         text-align: center;
         padding: 10px;
         font-size: 14px;
         color: #f0e6d2;
      }




      hr {
         border: none;
         height: 2px;
         background-color: rgba(106, 93, 90, 0.8);
         width: 100%; /* 전체 너비 */
         margin: 20px 0;
      }

      /* 블러 처리된 배경 */
      .background {
         position: fixed; /* 화면 고정 */
         top: 0; /* 화면 상단부터 시작 */
         left: 0; /* 화면 왼쪽부터 시작 */
         width: 100%; /* 화면 전체 너비 */
         height: 100%; /* 화면 전체 높이 */
         z-index: -1; /* 콘텐츠보다 뒤에 위치 */
         background: url('/images/image.png') no-repeat center center fixed; /* 이미지 배치 및 고정 */
         background-size: cover; /* 배경 이미지를 화면에 맞게 확장 */
         filter: blur(8px); /* 블러 효과 적용 */
      }

      /* 메인 콘텐츠 영역 - 기능 부분 */
      #content {
         margin-left: 220px; /* 사이드바 공간 확보 */
         padding: 20px; /* 내부 여백 */
         background-color: rgba(255, 255, 255, 0.85); /* 배경색 설정 (흰색) */
         border: 1px solid #e0e0e0; /* 얇은 테두리 추가 */
         border-radius: 10px; /* 모서리를 둥글게 설정 */
         box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* 부드러운 그림자 효과 추가 */
         font-family: 'Arial', sans-serif; /* 폰트 설정 */
         font-size: 16px; /* 기본 글꼴 크기 */
         line-height: 1.5; /* 줄 간격 설정 */
         color: #333; /* 텍스트 색상 설정 */
         max-width: 1000px; /* 최대 콘텐츠 너비 제한 */
         margin: 20px auto; /* 수평으로 가운데 정렬 */
         position: relative; /* 기본 문서 흐름에 따라 위치 */
         top: 10px; /* 상단에서 10px 아래로 위치 */
         flex-grow: 1;
         height: 500px;
         font-family: "IBM Plex Sans KR", serif;
         font-weight: 400;
         font-style: normal;
         overflow-y: auto; /* 세로 스크롤 활성화 */
         overflow-x: hidden; /* 가로 스크롤 비활성화 */
      }
      body {
         margin: 0; /* 기본 여백 제거 */
         padding: 0; /* 기본 패딩 제거 */
         font-family: 'A`rial', sans-serif; /* 기본 폰트 설정 */
         color: #333; /* 기본 텍스트 색상 */
         display: flex; /* 플렉스 컨테이너 설정 */
         flex-direction: column; /* 상단에서 아래로 콘텐츠 배치 */
      }
      /* 그리드 레이아웃을 사용하여 8개의 열로 파일 항목 배치 */
      .file-grid {
         display: grid;
         grid-template-columns: repeat(6, 1fr);  /* 6개의 열 */
         gap: 10px;
         margin: 20px 0;
      }
      .file-item {
         display: flex;
         flex-direction: column;
         align-items: center;
         padding: 15px;
         background-color: #fff; /* 카드 배경색 */
         border: 1px solid #ddd;
         border-radius: 8px;
         box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
         text-align: center;
      }
      .file-item:hover {
         background-color: #f9f9f9;
      }

      .file-name {
         font-size: 14px;
         font-weight: bold;
         color: #555;
         margin-bottom: 10px;
         word-wrap: break-word; /* 긴 파일명 줄바꿈 */
      }
      /* 파일 액션 버튼들 */
      .file-actions {
         display: flex;
         gap: 10px;
         justify-content: center;
      }


      /* 파일 선택 라벨 */
      .file-label {
         display: inline-block;
         padding: 10px 15px;
         background-color: rgba(106, 93, 90, 0.8); /* 메인 색상 */
         color: #fff;
         border-radius: 5px; /* 둥근 모서리 */
         font-size: 14px;
         font-weight: bold;
         cursor: pointer; /* 클릭 가능한 커서 */
         transition: background-color 0.3s ease, transform 0.2s ease;
      }

      /* 숨겨진 파일 입력 필드 */
      .file-input {
         display: none; /* 숨김 */
      }

      /* 파일 선택 라벨 호버 효과 */
      .file-label:hover {
         background-color: rgba(133, 101, 92, 0.8);
         transform: scale(1.05); /* 살짝 확대 */
      }

      /* 업로드 버튼 */
      .upload-button {
         background-color: rgba(106, 93, 90, 0.8); /* 메인 색상 */
         color: #fff; /* 텍스트 색상 */
         border: none;
         padding: 10px 15px;
         border-radius: 5px;
         font-size: 14px;
         font-weight: bold;
         cursor: pointer;
         transition: background-color 0.3s ease, transform 0.2s ease;
      }

      /* 업로드 버튼 호버 효과 */
      .upload-button:hover {
         background-color: rgba(133, 101, 92, 0.8);
         transform: scale(1.05);
      }

      /* 삭제 버튼 */
      .delete-button {
         background-color: #d9534f; /* 빨간색 */
         color: #fff;
         border: none;
         padding: 7px 20px;
         border-radius: 5px;
         font-size: 134;
         font-weight: 400;
         cursor: pointer;
         margin-top: 5px;
         transition: background-color 0.3s ease, transform 0.2s ease;
      }

      /* 삭제 버튼 호버 효과 */
      .delete-button:hover {
         background-color: #c9302c; /* 더 어두운 빨간색 */
         transform: scale(1.05);
      }

      /* 다운로드 버튼 스타일 */
      form button[type="submit"] {
         background-color: rgba(106, 93, 90, 0.8); /* 메인 색상 */
         color: #fff;
         border: none;
         padding: 8px 12px;
         border-radius: 5px;
         cursor: pointer;
      }

      form button[type="submit"]:hover {
         background-color: rgba(133, 101, 92, 0.8);
      }

   </style>

</head>
<body>
<!-- 블러 처리된 배경 -->
<div class="background"></div>

<!-- 헤더 영역 -->
<header>

   <h1>Study Village</h1> <!-- 제목 -->
   <div class="auth-buttons">
      <button onclick="window.location.href='/index';">Logout</button> <!-- 로그아웃 버튼 -->
   </div>
   <div class="profile-container">
      <i class="fas fa-user-circle profile-icon"></i> <!-- Font Awesome 아이콘 -->
   </div>
</header>

<!-- 네비게이션 바 -->
<nav>
   <a th:href="@{'/partyBoardMainPage/' + ${party.partyId}}">BOARD</a>
   <a th:href="@{'/partyGameMainPage/' + ${party.partyId}}">GAME</a>
   <a th:href="@{'/partyChatMainPage/' + ${party.partyId}}">CHAT</a>
   <a th:href="@{'/partyFileMainPage/' + ${party.partyId}}">FILE</a>
   <a th:href="@{'/partySettingPage/' + ${party.partyId}}">SETTINGS</a>
</nav>

<div id="main-layout">
   <!-- 사이드바 -->
   <div id="sidebar">
      <div id="groupName">
         <h3>그룹</h3>
         <p th:text="${party.partyName}"></p> <!-- 그룹 이름 표시-->
      </div>
      <button onclick="toggleContainer(0)">계산기</button>
      <button onclick="toggleContainer(1)">그래프</button>
      <button onclick="toggleContainer(2)">수식변환</button>
      <button onclick="toggleContainer(3)">사전</button>
      <button onclick="toggleContainer(4)">맞춤법</button>
   </div>

   <!-- 기능 컨테이너들 -->
   <div id="containers">

      <!-- 계산기 -->
      <div class="container" id="calculator-container">
         <div class="header">계산기</div>
         <button class="close-btn" onclick="document.getElementById('graph-container').style.display='none'">x</button>

         <div class="content">
            <div class="calculator">
               <div class="display-container">
                  <input type="text" id="display" readonly placeholder="0">

               </div>
               <div class="tabs">
                  <button class="tab active">기본</button>
                  <button class="tab">대수학</button>
                  <button class="tab">삼각법</button>
                  <button class="tab">미적분학</button>
                  <button class="tab">통계</button>
                  <button class="tab">문자</button>
                  <button class="tab">행렬</button>
               </div>
               <div class="buttons"></div>
            </div>
         </div>
      </div>


      <!-- Graph Container -->


      <div id="graph-container" class="container" style="display: none;">
         <div class="header">그래프 만들기</div>
         <button class="close-btn" onclick="document.getElementById('graph-container').style.display='none'">x</button>
         <div class="content">
            <div>
               <label for="graphType">그래프 종류:</label>
               <select id="graphType">
                  <option value="line">선 그래프</option>
                  <option value="bar">막대 그래프</option>
                  <option value="pie">원 그래프</option>
                  <option value="doughnut">도넛 그래프</option>
               </select>
            </div>
            <div>
               <label for="labelsInput">가로축(쉼표로 구분):</label>
               <input type="text" id="labelsInput" placeholder="예시 : 1월, 2월, 3월">
            </div>
            <div>
               <label for="dataInput">세로축(쉼표로 구분):</label>
               <input type="text" id="dataInput" placeholder="예시 : 10, 20, 15">
            </div>
            <button onclick="updateGraph()">만들기</button>
            <canvas id="myChart" width="400" height="200"></canvas>
         </div>
      </div>


      <!-- 수식변환 -->
      <div class="container" id="formula-container">
         <div class="header">수학공식 변환기</div>
         <button class="close-btn" onclick="document.getElementById('graph-container').style.display='none'">x</button>

         <p>아래 입력창에 바꿀 내용을 입력해보세요:</p>
         <input type="text" id="formulaInput" placeholder="예시 : a^2 + b^2 = c^2">
         <button onclick="renderFormula()">바꾸기</button>

         <h2>바꾼 공식</h2>
         <div id="output" style="margin-top: 20px; font-size: 20px; color: #333;"></div>
      </div>

      <!-- 사전 -->
      <div class="container" id="dictionary-container">
         <div class="header">영어 사전</div>
         <button class="close-btn" onclick="document.getElementById('dictionary-container').style.display='none'">x</button>

         <div>
            <input type="text" id="word" placeholder="단어를 입력하세요..">
            <button onclick="lookupWord()">찾기</button>
         </div>
         <div id="definition"></div>
      </div>

      <!-- 맞춤법 -->
      <div class="container" id="spellcheck-container">
         <div class="header">맞춤법 검사기</div>
         <button class="close-btn" onclick="document.getElementById('graph-container').style.display='none'">x</button>

         <div>
            <textarea id="text" rows="4" cols="50" placeholder="확인할 내용을 입력하세요..."></textarea>
            <br>
            <button onclick="checkSpelling()">확인하기</button>
         </div>
         <div id="result"></div>
      </div>


   </div>
   <div id="content">
      <h2>마을 파일 창고</h2>
      <hr>
      <h3>파일 올리기</h3>
      <form action="/party/file/upload" method="post" enctype="multipart/form-data">
         <input type="hidden" name="partyId" th:value="${party.partyId}">
         <label for="file"></label>
         <input type="file" id="file" name="file" required>
         <button type="submit">업로드</button>
      </form>
      <hr>
      <!-- 파일 목록을 그리드 레이아웃으로 표시 -->
      <div class="file-grid">
         <div th:each="file : ${fileList}" class="file-item" id="file-item-[[${file.fileId}]]">
            <p class="file-name" th:text="${file.fileName}">File Name</p>

            <!-- 이미지 파일 미리보기 -->
            <div class="file-preview">
               <!-- 이미지 파일들 -->
               <img th:if="${file.fileName.endsWith('.png') or file.fileName.endsWith('.jpg') or file.fileName.endsWith('.jpeg')}"
                   th:src="@{'/party/file/download/' + ${file.fileId}}"
                   alt="Image Preview" width="50px" />

               <!-- PDF 아이콘 -->
               <img th:if="${file.fileName.endsWith('.pdf')}"
                   src="/images/fileIcon/pdf-icon.png"
                   alt="PDF Icon" width="50px" />

               <!-- Word 아이콘 -->
               <img th:if="${file.fileName.endsWith('.doc') or file.fileName.endsWith('.docx')}"
                   src="/images/fileIcon/doc-icon.png"
                   alt="Word Icon" width="50px" />

               <!-- Excel 아이콘 -->
               <img th:if="${file.fileName.endsWith('.xls') or file.fileName.endsWith('.xlsx')}"
                   src="/images/fileIcon/xls-icon.png"
                   alt="Excel Icon" width="50px" />

               <!-- PowerPoint 아이콘 -->
               <img th:if="${file.fileName.endsWith('.ppt') or file.fileName.endsWith('.pptx')}"
                   src="/images/fileIcon/ppt-icon.png"
                   alt="PowerPoint Icon" width="50px" />

               <!-- 텍스트 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.txt')}"
                   src="/images/fileIcon/txt-icon.png"
                   alt="Text Icon" width="50px" />

               <!-- HTML 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.html') or file.fileName.endsWith('.htm')}"
                   src="/images/fileIcon/html-icon.png"
                   alt="HTML Icon" width="50px" />

               <!-- 압축 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.zip') or file.fileName.endsWith('.rar')}"
                   src="/images/fileIcon/zip-icon.png"
                   alt="Zip Icon" width="50px" />

               <!-- JavaScript 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.js')}"
                   src="/images/fileIcon/js-icon.png"
                   alt="JavaScript Icon" width="50px" />

               <!-- CSS 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.css')}"
                   src="/images/fileIcon/css-icon.png"
                   alt="CSS Icon" width="50px" />

               <!-- JSON 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.json')}"
                   src="/images/fileIcon/json-icon.png"
                   alt="JSON Icon" width="50px" />

               <!-- XML 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.xml')}"
                   src="/images/fileIcon/xml-icon.png"
                   alt="XML Icon" width="50px" />

               <!-- CSV 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.csv')}"
                   src="/images/fileIcon/csv-icon.png"
                   alt="CSV Icon" width="50px" />

               <!-- Audio 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.mp3') or file.fileName.endsWith('.wav') or file.fileName.endsWith('.ogg')}"
                   src="/images/fileIcon/mp3-icon.png"
                   alt="Audio Icon" width="50px" />

               <!-- Video 파일 아이콘 -->
               <img th:if="${file.fileName.endsWith('.mp4') or file.fileName.endsWith('.avi') or file.fileName.endsWith('.mov')}"
                   src="/images/fileIcon/mp4-icon.png"
                   alt="Video Icon" width="50px" />

               <!-- 기타 파일 아이콘 (기본 파일 아이콘) -->
               <img th:if="${!(file.fileName.endsWith('.png') or file.fileName.endsWith('.jpg') or file.fileName.endsWith('.jpeg') or file.fileName.endsWith('.pdf') or file.fileName.endsWith('.doc') or file.fileName.endsWith('.docx') or file.fileName.endsWith('.xls') or file.fileName.endsWith('.xlsx') or file.fileName.endsWith('.ppt') or file.fileName.endsWith('.pptx') or file.fileName.endsWith('.txt') or file.fileName.endsWith('.html') or file.fileName.endsWith('.htm') or file.fileName.endsWith('.zip') or file.fileName.endsWith('.rar') or file.fileName.endsWith('.js') or file.fileName.endsWith('.css') or file.fileName.endsWith('.json') or file.fileName.endsWith('.xml') or file.fileName.endsWith('.csv') or file.fileName.endsWith('.mp3') or file.fileName.endsWith('.wav') or file.fileName.endsWith('.ogg') or file.fileName.endsWith('.mp4') or file.fileName.endsWith('.avi') or file.fileName.endsWith('.mov'))}"
                   src="/images/fileIcon/124837.png"
                   alt="File Icon" width="50px" />
            </div>

            <!-- 다운로드 및 삭제 버튼 -->
            <form th:action="@{'/party/file/download/' + ${file.fileId}}" method="get">
               <button type="submit">다운로드</button>
            </form>

            <button class="delete-button" th:attr="onclick='deleteFile(' + ${file.fileId} + ')'" type="button">삭제</button>
         </div>
      </div>



   </div>

</div>


</body>

<!-- 푸터 영역 -->
<footer>
   &copy; 2024 Study Village. All rights reserved. <!-- 푸터 텍스트 -->
</footer>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script src="/js/container.js"></script>
<script src="/js/calculator.js"></script>
<script src="/js/dictionary.js"></script>
<script src="/js/graph.js"></script>
<script src="/js/formula.js"></script>
<script src="/js/checkspell.js"></script>

<script>
   function deleteFile(fileId) {
      fetch(`/party/file/delete/${fileId}`, {
         method: 'DELETE',
      })
            .then(response => response.text())
            .then(data => {
               console.log(data);
               // 삭제 후 페이지 새로 고침
               location.reload();  // 페이지를 새로 고침
            })
            .catch(error => console.error('Error:', error));
   }
</script>


</html>